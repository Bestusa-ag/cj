<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="icon" href="./assets/img/story-sprouts-logo.svg"> <!-- Consider updating the icon to match the new theme -->
<title>Browse Courses - Communicate Well</title>
<meta name="description" content="Start learning now with Communicate Well! A collection of free, practical online courses on communication skills.">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="assets/css/style.css" />
<style>
  body { margin:0; background:#000000; color:#ffffff; font-family:'Inter',sans-serif; }
  canvas { display:block; margin:60px auto; background:#1b1f29; border:4px solid #222832; }
  h1 { text-align:center; margin-top:20px; }
  p { text-align:center; }
</style>
</head>
<body>
<nav class="nav">
  <div class="container nav-inner">
    <a class="logo" href="index.html" aria-label="Home"><img src="./assets/img/story-sprouts-logo.svg" alt="Communicate Well icon"><span>Communicate Well</span></a>
    <div class="menu" data-nav-menu>
      <a href="index.html">Home</a>
      <a href="game.html" class="active">Browse Courses</a>
      <a href="leaderboard.html">Top Learners</a>
      <a href="about.html">About</a>
      <a href="blog.html">Blog</a>
      <a href="faq.html">FAQ</a>
      <a href="privacy.html">Privacy</a>
      <a href="terms.html">Terms</a>
    </div>
    <div class="right"><a class="btn ghost" data-nav-toggle>Menu</a><a class="btn" href="game.html">Browse Courses</a></div>
  </div>
</nav>

<h1>Course Viewer</h1>
<p>This is a placeholder for a course. Use the controls to navigate lessons!</p>
<canvas id="book-canvas" width="800" height="500"></canvas>

<script>
(function(){
  const canvas = document.getElementById('book-canvas');
  const ctx = canvas.getContext('2d');
  const W = canvas.width, H = canvas.height;

  // --- State ---
  const book = { 
    currentLesson: 1, 
    totalLessons: 10,
    coursesCompleted: parseInt(localStorage.getItem('cw_coursesCompleted') || '0') 
  };
  let isCourseFinished = false;

  // --- Drawing Functions ---
  function drawBackground() {
    ctx.fillStyle = "#1b1f29";
    ctx.fillRect(0, 0, W, H);
  }

  function drawBook() {
    // Book cover/pages
    ctx.fillStyle = "#fff";
    ctx.fillRect(50, 50, W - 100, H - 100);
    
    // Page content
    ctx.fillStyle = "#000";
    ctx.font = "20px Inter";
    ctx.textAlign = "left";
    ctx.fillText(`This is lesson ${book.currentLesson} of an amazing course.`, 70, 100);
    ctx.fillText(`Imagine an insightful video or graphic here!`, 70, 140);

    // Page number
    ctx.textAlign = "center";
    ctx.fillText(`Lesson ${book.currentLesson} / ${book.totalLessons}`, W / 2, H - 20);
  }

  function drawEndScreen() {
    ctx.fillStyle = "rgba(27, 31, 41, 0.85)";
    ctx.fillRect(0, 0, W, H);
    ctx.fillStyle = "#fff";
    ctx.font = "32px Inter";
    ctx.textAlign = "center";
    ctx.fillText("Course Complete! You've finished " + book.coursesCompleted + " course(s)!", W / 2, H / 2 - 20);
    ctx.font = "20px Inter";
    ctx.fillText("Click or press 'R' to Start Another Course", W / 2, H / 2 + 30);
  }

  function drawUI() {
    ctx.fillStyle = "#fff";
    ctx.font = "24px Inter";
    ctx.textAlign = "left";
    ctx.fillText("Courses Completed: " + book.coursesCompleted, 20, 40);
  }

  function render() {
    drawBackground();
    drawBook();
    drawUI();
    if (isCourseFinished) {
      drawEndScreen();
    }
  }

  // --- Logic ---
  function nextLesson(direction) {
    if (isCourseFinished) return;
    book.currentLesson += direction;
    if (book.currentLesson < 1) book.currentLesson = 1;
    if (book.currentLesson > book.totalLessons) book.currentLesson = book.totalLessons;
    
    if (book.currentLesson === book.totalLessons) {
      isCourseFinished = true;
      book.coursesCompleted++;
      localStorage.setItem('cw_coursesCompleted', book.coursesCompleted);
      const lb = JSON.parse(localStorage.getItem('cw_leaderboard') || '[]');
      lb.push({ score: book.coursesCompleted, at: Date.now() });
      lb.sort((a, b) => b.score - a.score);
      localStorage.setItem('cw_leaderboard', JSON.stringify(lb.slice(0, 50)));
    }
    render();
  }
  
  function startAnotherCourse() {
    book.currentLesson = 1;
    isCourseFinished = false;
    render();
  }

  // --- Event Listeners ---
  window.addEventListener('keydown', e=>{
    if (isCourseFinished) {
      if (e.key === 'r' || e.key === 'R') startAnotherCourse();
      return;
    }
    if(e.key === "ArrowLeft") nextLesson(-1);
    if(e.key === "ArrowRight") nextLesson(1);
  });

  canvas.addEventListener('click', () => {
    if(isCourseFinished) {
      startAnotherCourse();
    }
  });

  // Initial render
  render();
})();
</script>
</body>
</html>
